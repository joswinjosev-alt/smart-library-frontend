<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Smart Library — Single Page Demo</title>
  <style>
    :root{
      --accent:#ff7a00;
      --bg:#ffffff;
      --muted:#f6f6f6;
      --text:#222;
      --seat-size:64px;
      --reserved:#ffddc8;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#fff);color:var(--text);min-height:100vh}
    header{display:flex;align-items:center;gap:16px;padding:18px 24px;border-bottom:1px solid #eee}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .mark{width:42px;height:42px;border-radius:10px;background:var(--accent);display:grid;place-items:center;color:white;font-weight:700}
    h1{font-size:18px;margin:0}
    nav{margin-left:auto;display:flex;gap:12px}
    nav button{background:transparent;border:none;color:var(--accent);font-weight:600;cursor:pointer;padding:8px 10px;border-radius:8px}
    nav button.active{background:var(--accent);color:white}

    /* page container */
    .page-wrap{padding:20px;max-width:1200px;margin:18px auto}
    .page{display:none;opacity:0;transform:translateY(6px);transition:opacity .25s, transform .25s}
    .page.visible{display:block;opacity:1;transform:translateY(0)}

    /* Home */
    .hero{padding:40px 20px;text-align:center}
    .hero h2{color:var(--accent);font-size:32px;margin:0 0 8px}
    .hero p{max-width:900px;margin:8px auto;color:#555;line-height:1.6}
    .btn{display:inline-block;margin-top:18px;padding:10px 18px;background:var(--accent);color:#fff;border-radius:8px;text-decoration:none;cursor:pointer;border:none}

    /* Seat Map layout */
    .container{display:grid;grid-template-columns:300px 1fr;gap:20px;margin-top:12px}
    .panel{background:var(--muted);padding:14px;border-radius:12px}
    .legend{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .legend .item{display:flex;gap:8px;align-items:center;padding:6px 8px;border-radius:8px;background:white}
    .chip{width:14px;height:14px;border-radius:4px}
    .chip.free{background:transparent;border:2px solid #ddd}
    .chip.occupied{background:var(--accent)}
    .chip.reserved{background:#ffb380}

    .map-wrap{padding:10px}
    .map{display:grid;grid-template-columns:repeat(8,1fr);gap:14px;align-items:center;justify-items:center}
    .floor-label{grid-column:1/-1;padding:8px 12px;border-radius:8px;background:white;font-weight:700;margin-top:8px}
    .seat{
      width:var(--seat-size);height:var(--seat-size);display:flex;align-items:center;justify-content:center;border-radius:12px;border:2px dashed transparent;user-select:none;transition:transform .12s,opacity .12s;position:relative;background:white;box-shadow:0 6px 14px rgba(0,0,0,0.06)
    }
    .seat .label{font-weight:700}
    .seat.free{border-color:#e6e6e6;background:white;color:var(--text)}
    .seat.occupied{background:var(--accent);color:white}
    .seat.reserved{background:var(--reserved)}
    .seat .status{position:absolute;bottom:6px;font-size:11px;opacity:0.9}

    /* Book page */
    .search{display:flex;gap:10px;margin-bottom:18px}
    .search input{flex:1;padding:10px;border-radius:8px;border:1px solid #ddd}
    .book-list{background:var(--muted);padding:12px;border-radius:10px}
    table{width:100%;border-collapse:collapse}
    th,td{padding:10px;border-bottom:1px solid #eee;text-align:left}
    th{background:white}

    /* responsive */
    @media(max-width:900px){
      .container{grid-template-columns:1fr}
      .map{grid-template-columns:repeat(4,1fr)}
      .panel{order:2}
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <div class="mark">SLS</div>
      <div><h1>Smart Library System</h1></div>
    </div>
    <nav>
      <button id="navHome" class="active">Home</button>
      <button id="navSeat">Seat Map</button>
      <button id="navBooks">Book Locations</button>
    </nav>
  </header>

  <div class="page-wrap">
    <!-- HOME -->
    <section id="home" class="page visible">
      <div class="hero panel">
        <h2>Welcome to Smart Library</h2>
        <p>This demo shows a live seat occupancy map and a book-locator page. Seats are grouped by floor (Floor 1, Floor 2). Free seats are white, reserved seats are light orange, occupied seats are orange.</p>
        <div style="margin-top:14px">
          <button class="btn" onclick="showPage('seat')">Open Seat Map</button>
          <button class="btn" onclick="showPage('books')">Open Book Locations</button>
        </div>
      </div>
    </section>

    <!-- SEAT MAP -->
    <section id="seat" class="page" aria-hidden="true">
      <div class="container">
        <aside>
          <div class="panel">
            <h3 style="margin:4px 0 10px">Legend & Stats</h3>
            <div>
              <strong>Legend</strong>
              <div class="legend">
                <div class="item"><div class="chip free"></div><div>Free</div></div>
                <div class="item"><div class="chip occupied"></div><div>Occupied</div></div>
                <div class="item"><div class="chip reserved"></div><div>Reserved</div></div>
              </div>
            </div>

            <div style="height:12px"></div>

            <div>
              <strong>Stats</strong>
              <div style="display:flex;gap:10px;flex-wrap:wrap;margin-top:8px">
                <div style="background:white;padding:12px;border-radius:10px;min-width:110px">Total seats<div id="totalCnt" style="font-weight:700;font-size:18px">8</div></div>
                <div style="background:white;padding:12px;border-radius:10px;min-width:110px">Free<div id="freeCnt" style="font-weight:700;font-size:18px">-</div></div>
                <div style="background:white;padding:12px;border-radius:10px;min-width:110px">Occupied<div id="occCnt" style="font-weight:700;font-size:18px">-</div></div>
                <div style="background:white;padding:12px;border-radius:10px;min-width:110px">Reserved<div id="resCnt" style="font-weight:700;font-size:18px">-</div></div>
              </div>
            </div>
          </div>
        </aside>

        <main>
          <div class="map-wrap panel">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
              <strong>Library Map — Live</strong>
              <div style="font-size:13px;color:#666">Status updates come from backend.</div>
            </div>

            <div id="map" class="map" aria-hidden="false"></div>
          </div>
        </main>
      </div>
    </section>

    <!-- BOOKS -->
    <section id="books" class="page" aria-hidden="true">
      <div class="panel" style="max-width:980px;margin:0 auto">
        <h2 style="color:var(--accent)">Find Book Location</h2>
        <div class="search" style="margin-top:12px">
          <input id="searchBox" placeholder="Search by title or author..." oninput="searchBooks()" />
          <button onclick="searchBooks()" style="background:var(--accent);color:#fff;border:none;padding:10px 14px;border-radius:8px;cursor:pointer">Search</button>
        </div>

        <div class="book-list" style="margin-top:12px">
          <table id="bookTable">
            <thead><tr><th>Title</th><th>Author</th><th>Floor</th><th>Section</th><th>Shelf</th></tr></thead>
            <tbody></tbody>
          </table>
          <p id="noRes" style="display:none;color:#777;font-style:italic;margin-top:10px">No books found.</p>
        </div>
      </div>
    </section>
  </div>

  <footer style="text-align:center;padding:18px;color:#666">Demo created for ECE Smart Library project</footer>

  <script>
    // ===== BACKEND URL (replace with your Render URL) =====
    const API_URL = "https://YOUR-BACKEND-ONRENDER.com";  // <-- change this later

    // ---------- Page navigation ----------
    const pages = {
      home: document.getElementById('home'),
      seat: document.getElementById('seat'),
      books: document.getElementById('books')
    };
    const navHome = document.getElementById('navHome');
    const navSeat = document.getElementById('navSeat');
    const navBooks = document.getElementById('navBooks');

    function setActiveNav(btn){
      [navHome, navSeat, navBooks].forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
    }

    function showPage(id){
      Object.values(pages).forEach(p=>{ p.classList.remove('visible'); p.setAttribute('aria-hidden','true'); });
      pages[id].classList.add('visible');
      pages[id].setAttribute('aria-hidden','false');
      if(id==='home') setActiveNav(navHome);
      if(id==='seat') setActiveNav(navSeat);
      if(id==='books') setActiveNav(navBooks);
    }

    navHome.addEventListener('click', ()=>showPage('home'));
    navSeat.addEventListener('click', ()=>showPage('seat'));
    navBooks.addEventListener('click', ()=>showPage('books'));

    showPage('home');

    // ===== SEAT DATA (A1–A4, B1–B4) =====
    const seats = [
      { id: 'A1', floor: 1, label: 'A1', status: 'free' },
      { id: 'A2', floor: 1, label: 'A2', status: 'free' },
      { id: 'A3', floor: 1, label: 'A3', status: 'free' },
      { id: 'A4', floor: 1, label: 'A4', status: 'free' },

      { id: 'B1', floor: 2, label: 'B1', status: 'free' },
      { id: 'B2', floor: 2, label: 'B2', status: 'free' },
      { id: 'B3', floor: 2, label: 'B3', status: 'free' },
      { id: 'B4', floor: 2, label: 'B4', status: 'free' },
    ];

    const mapEl = document.getElementById('map');

    function renderMap(){
      mapEl.innerHTML = '';
      [1,2].forEach(floorNum => {
        const floorLabel = document.createElement('div');
        floorLabel.className = 'floor-label';
        floorLabel.textContent = `Floor ${floorNum}`;
        mapEl.appendChild(floorLabel);

        const floorSeats = seats.filter(s => s.floor === floorNum);
        floorSeats.forEach(s => {
          const el = document.createElement('div');
          el.className = 'seat ' + s.status;
          el.dataset.id = s.id;
          el.title = `${s.label} — ${s.status}`;
          el.innerHTML = `<div class="label">${s.label}</div><div class="status">${s.status}</div>`;
          mapEl.appendChild(el);
        });
      });
      updateCounts();
    }

    function updateCounts(){
      document.getElementById('totalCnt').textContent = seats.length;
      document.getElementById('freeCnt').textContent = seats.filter(s=>s.status==='free').length;
      document.getElementById('occCnt').textContent = seats.filter(s=>s.status==='occupied').length;
      document.getElementById('resCnt').textContent = seats.filter(s=>s.status==='reserved').length;

      document.querySelectorAll('.seat').forEach(el=>{
        const s = seats.find(x=>x.id===el.dataset.id);
        el.className = 'seat ' + s.status;
        const st = el.querySelector('.status'); 
        if(st) st.textContent = s.status;
      });
    }

    // ===== Live backend sync =====
    async function fetchSeatData(){
      try{
        const res = await fetch(`${API_URL}/seats`);
        if(!res.ok) throw new Error('Bad response');
        const data = await res.json();
        // Expected JSON: { "A1": "free", "A2": "occupied", ... }
        seats.forEach(s => {
          if(data[s.id]) s.status = data[s.id];  // free / occupied / reserved
        });
        renderMap();
      }catch(err){
        console.log('Backend not reachable or error:', err.message);
      }
    }

    setInterval(fetchSeatData, 1000);
    renderMap();
    fetchSeatData();

    // ===== BOOK DATA =====
    const books = [
      // Floor 1 — 10 books (Sections A/B/C)
      {title:'Digital Electronics',author:'M. Morris Mano',floor:'Floor 1',section:'A',shelf:'Shelf 1'},
      {title:'Signals and Systems',author:'Oppenheim',floor:'Floor 1',section:'A',shelf:'Shelf 2'},
      {title:'C Programming',author:'Dennis Ritchie',floor:'Floor 1',section:'B',shelf:'Shelf 1'},
      {title:'Data Structures in C',author:'Reema Thareja',floor:'Floor 1',section:'C',shelf:'Shelf 2'},
      {title:'Analog Electronics',author:'Sedra/Smith',floor:'Floor 1',section:'B',shelf:'Shelf 1'},
      {title:'Control Systems',author:'Nagrath & Gopal',floor:'Floor 1',section:'C',shelf:'Shelf 2'},
      {title:'Engineering Maths 1',author:'B.S. Grewal',floor:'Floor 1',section:'A',shelf:'Shelf 1'},
      {title:'Circuit Theory',author:'V.K. Mehta',floor:'Floor 1',section:'B',shelf:'Shelf 2'},
      {title:'Signals Lab Manual',author:'MIT Press',floor:'Floor 1',section:'C',shelf:'Shelf 1'},
      {title:'Basic Electronics',author:'J.B. Gupta',floor:'Floor 1',section:'A',shelf:'Shelf 2'},

      // Floor 2 — 10 books
      {title:'Embedded Systems',author:'Raj Kamal',floor:'Floor 2',section:'A',shelf:'Shelf 1'},
      {title:'Python for Everyone',author:'Charles Severance',floor:'Floor 2',section:'A',shelf:'Shelf 2'},
      {title:'Microprocessor Basics',author:'Gaonkar',floor:'Floor 2',section:'B',shelf:'Shelf 1'},
      {title:'Network Analysis',author:'Van Valkenburg',floor:'Floor 2',section:'C',shelf:'Shelf 2'},
      {title:'Communication Systems',author:'Simon Haykin',floor:'Floor 2',section:'B',shelf:'Shelf 1'},
      {title:'Digital Signal Processing',author:'Proakis',floor:'Floor 2',section:'C',shelf:'Shelf 2'},
      {title:'Machine Learning Basics',author:'Tom Mitchell',floor:'Floor 2',section:'A',shelf:'Shelf 1'},
      {title:'Operating Systems',author:'Galvin',floor:'Floor 2',section:'B',shelf:'Shelf 2'},
      {title:'Computer Networks',author:'Tanenbaum',floor:'Floor 2',section:'C',shelf:'Shelf 1'},
      {title:'IoT Fundamentals',author:'Cisco Press',floor:'Floor 2',section:'A',shelf:'Shelf 2'}
    ];

    const tbody = document.querySelector('#bookTable tbody');
    const noRes = document.getElementById('noRes');

    function renderBooks(list){
      tbody.innerHTML = '';
      if(list.length === 0){
        noRes.style.display = 'block';
        document.getElementById('bookTable').style.display = 'none';
      } else {
        noRes.style.display = 'none';
        document.getElementById('bookTable').style.display = 'table';
        list.forEach(b=>{
          const tr = document.createElement('tr');
          tr.innerHTML = `<td>${b.title}</td><td>${b.author}</td><td>${b.floor}</td><td>${b.section}</td><td>${b.shelf}</td>`;
          tbody.appendChild(tr);
        });
      }
    }

    function searchBooks(){
      const q = document.getElementById('searchBox').value.toLowerCase().trim();
      const filtered = books.filter(b =>
        b.title.toLowerCase().includes(q) ||
        b.author.toLowerCase().includes(q)
      );
      renderBooks(filtered);
    }

    renderBooks(books);
    src="script.js";
  </script>
</body>
</html>
